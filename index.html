<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PerturbDiff: Functional Diffusion for Single-Cell Perturbation Modeling</title>
  <style>
    :root {
      --max-width: 1800px;
      --bg: #ffffff;
      --text: #1a1a1a;
      --text-muted: #555;
      --accent: #0d9488;
      --accent-soft: #ccfbf1;
      --blue: #0369a1;
      --blue-soft: #e0f2fe;
      --border: #e5e7eb;
      --spacing-section: 80px;
      --spacing-block: 24px;
      --font-sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }

    html { scroll-behavior: smooth; font-size: 175%; }
    *, *::before, *::after { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: var(--font-sans);
      font-size: 1rem;
      line-height: 1.6;
      color: var(--text);
      background: var(--bg);
    }

    .navbar {
      position: sticky;
      top: 0;
      z-index: 100;
      background: rgba(255, 255, 255, 0.98);
      border-bottom: 1px solid var(--border);
      padding: 12px 5%;
    }
    .navbar-inner {
      max-width: var(--max-width);
      margin: 0 auto;
      display: grid;
      grid-template-columns: 1fr auto;
      align-items: center;
      gap: 16px;
    }
    .navbar-brand {
      font-weight: 700;
      font-size: 1.25rem;
      color: var(--text);
      text-decoration: none;
      letter-spacing: -0.02em;
    }
    .navbar-links {
      display: flex;
      flex-wrap: nowrap;
      gap: 4px;
      justify-content: flex-end;
      align-items: center;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }
    .navbar-links a {
      color: var(--text-muted);
      text-decoration: none;
      font-size: 0.8rem;
      padding: 5px 10px;
      border-radius: 6px;
      transition: color 0.15s, background 0.15s;
      white-space: nowrap;
    }
    .navbar-links a:hover {
      color: var(--accent);
      background: var(--accent-soft);
    }

    .page {
      max-width: var(--max-width);
      margin: 0 auto;
      padding: 0 0 60px;
    }
    .page-content {
      padding: 0 20% 0;
    }

    .hero {
      padding: var(--spacing-section) 0;
      text-align: center;
    }
    .hero-title {
      font-size: clamp(1.5rem, 3.4vw, 2.15rem);
      font-weight: 700;
      letter-spacing: -0.02em;
      margin: 0 0 12px;
      color: var(--text);
      line-height: 1.3;
      margin-left: auto;
      margin-right: auto;
    }
    .hero-title-line {
      display: block;
      white-space: nowrap;
    }
    @media (max-width: 640px) {
      .hero-title-line { white-space: normal; }
    }
    .hero-title-highlight {
      color: var(--blue);
    }
    .hero-subtitle {
      font-size: 1.1rem;
      color: var(--text-muted);
      margin: 0 0 16px;
      font-weight: 500;
    }
    .hero-authors {
      font-size: 0.6rem;
      margin: 0 0 6px;
    }
    .hero-authors a {
      color: var(--blue);
      text-decoration: none;
    }
    .hero-authors a:hover { text-decoration: underline; }
    .hero-affiliations {
      font-size: 0.6rem;
      color: var(--text-muted);
      margin: 0 0 4px;
      line-height: 1.5;
    }
    .hero-contribution {
      font-size: 0.6rem;
      color: var(--text-muted);
      margin: 0 0 20px;
      font-style: italic;
    }
    .hero-contribution-line {
      display: block;
      margin-top: 0.25em;
    }
    .hero-contribution-line:first-child { margin-top: 0; }
    .hero-logos {
      display: flex;
      flex-wrap: wrap;
      gap: 24px;
      justify-content: center;
      align-items: center;
      margin: 0 0 24px;
    }
    .hero-logos img {
      width: auto;
      object-fit: contain;
    }
    .hero-logos .logo-mila { height: 95px; }
    .hero-logos .logo-udem { height: 85px; }
    .hero-logos .logo-ottawa { height: 105px; }
    .hero-logos .logo-hec { height: 98px; }
    .hero-summary {
      font-size: 1rem;
      color: var(--text);
      margin: 0 0 24px;
      max-width: 560px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.5;
    }
    .hero-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      justify-content: center;
      margin-bottom: var(--spacing-block);
    }
    .hero-buttons .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-size: 0.6rem;
    }
    .hero-buttons .btn-icon {
      width: 18px;
      height: 18px;
      flex-shrink: 0;
    }
    .btn {
      display: inline-block;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 0.95rem;
      font-weight: 500;
      text-decoration: none;
      transition: background 0.15s, color 0.15s, box-shadow 0.15s;
      border: 1px solid transparent;
    }
    .btn-primary {
      background: var(--accent);
      color: white;
    }
    .btn-primary:hover {
      background: #0f766e;
      box-shadow: 0 4px 12px rgba(13, 148, 136, 0.3);
    }
    .btn-secondary {
      background: var(--bg);
      color: var(--text);
      border-color: var(--border);
    }
    .btn-secondary:hover {
      background: var(--blue-soft);
      border-color: var(--blue);
      color: var(--blue);
    }

    section {
      padding: var(--spacing-section) 0 0;
    }
    section:first-of-type { padding-top: 0; }
    .hero-video-wrap {
      margin: var(--spacing-block) 0 var(--spacing-section);
      text-align: center;
    }
    .hero-video-wrap video {
      max-width: min(560px, 100%);
      width: 100%;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    }
    .section-title {
      font-size: 1.00rem;
      font-weight: 700;
      margin: 0 0 var(--spacing-block);
      color: var(--text);
      letter-spacing: -0.02em;
    }
    .subsection-title {
      font-size: 0.80rem;
      font-weight: 600;
      margin: 1.5rem 0 0.75rem;
      color: var(--text);
      letter-spacing: -0.01em;
    }
    #results .subsection-title:first-of-type { margin-top: 0; }

    .abstract {
      font-size: 0.5rem;
      color: var(--text);
      max-width: 100%;
      margin: 0;
    }

    .motivation-grid,
    .two-col-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 40px;
      align-items: start;
    }
    #motivation .motivation-grid {
      grid-template-columns: 1fr;
    }
    #motivation .motivation-grid .fig-wrap {
      max-width: 110%;
      margin-left: -5%;
      margin-right: -5%;
      width: 110%;
      box-sizing: content-box;
    }
    #motivation .motivation-grid .fig-wrap .fig-img.loaded,
    #motivation .motivation-grid .fig-wrap .fig-placeholder {
      width: 100%;
      max-width: none;
    }
    #motivation .fig-caption {
      text-align: left;
    }

    .fig-placeholder {
      width: 100%;
      aspect-ratio: 4/3;
      background: linear-gradient(135deg, var(--accent-soft), var(--blue-soft));
      border: 1px dashed var(--accent);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-muted);
      font-size: 0.9rem;
    }
    .fig-img {
      max-width: 100%;
      height: auto;
      display: none;
      border-radius: 12px;
    }
    .fig-wrap .fig-img.loaded { display: block; }
    .fig-wrap .fig-placeholder.hidden { display: none; }

    .fig-caption {
      font-size: 0.5rem;
      color: var(--text-muted);
      margin-top: 8px;
      line-height: 1.4;
    }

    .data-props-fig-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 24px;
      margin-bottom: var(--spacing-block);
    }
    .data-props-fig-grid .data-props-fig-item {
      margin: 0;
      min-width: 0;
      overflow: hidden;
    }
    .data-props-fig-grid .data-props-fig-item.data-props-fig-span2 {
      grid-column: span 2;
    }
    .data-props-fig-grid .data-props-fig-item.data-props-fig-full-row {
      grid-column: span 2;
    }
    .data-props-fig-grid .data-props-fig-item.data-props-fig-span2-row {
      grid-row: span 2;
    }
    .data-props-fig-grid .data-props-fig-item img {
      width: 100%;
      height: auto;
      display: block;
      border-radius: 8px;
    }
    .data-props-fig-grid .data-props-fig-2,
    .data-props-fig-grid .data-props-fig-3 {
      display: flex;
      flex-direction: column;
    }
    .data-props-fig-grid .data-props-fig-2 img,
    .data-props-fig-grid .data-props-fig-3 img {
      width: 100%;
      height: auto;
      aspect-ratio: 16/10;
      object-fit: contain;
      object-position: center bottom;
      flex-shrink: 0;
      display: block;
    }
    .data-props-fig-grid .data-props-fig-2 .fig-caption,
    .data-props-fig-grid .data-props-fig-3 .fig-caption {
      margin-top: 6px;
      flex-shrink: 0;
    }
    .data-props-fig-grid .data-props-fig-item.data-props-fig-narrow-tall {
      width: 75%;
      max-width: 100%;
      margin-left: auto;
      margin-right: auto;
      aspect-ratio: 3/4;
      overflow: hidden;
    }
    .data-props-fig-grid .data-props-fig-item.data-props-fig-narrow-tall img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      object-position: center;
    }
    .data-props-fig-grid .data-props-fig-1 img { max-width: 100%; }
    .data-props-fig-grid .data-props-fig-2 img { max-width: 100%; }
    .data-props-fig-grid .data-props-fig-3 img { max-width: 100%; }
    .data-props-fig-grid .data-props-fig-4 img { max-width: 100%; }
    .data-props-fig-grid .data-props-fig-5 img { max-width: 100%; }
    .data-props-fig-grid .data-props-fig-6 img { max-width: 100%; }
    .data-props-fig-grid .fig-caption {
      margin-top: 6px;
    }
    @media (max-width: 500px) {
      .data-props-fig-grid { grid-template-columns: 1fr; }
      .data-props-fig-grid .data-props-fig-item.data-props-fig-span2 { grid-column: span 1; }
      .data-props-fig-grid .data-props-fig-item.data-props-fig-full-row { grid-column: span 1; }
    }

    .motivation-list,
    .data-props-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .motivation-list li,
    .data-props-list li {
      position: relative;
      padding-left: 1.25em;
      margin-bottom: 10px;
      font-size: 0.5rem;
    }
    .motivation-list li::before,
    .data-props-list li::before {
      content: "•";
      position: absolute;
      left: 0;
      color: var(--accent);
      font-weight: 700;
    }
    .data-props-list li { margin-bottom: 14px; }

    .method-figure-wrap {
      margin-bottom: 40px;
      text-align: center;
    }
    #method .method-figure-wrap.fig-wrap {
      max-width: 110%;
      margin-left: -5%;
      margin-right: -5%;
      width: 110%;
      box-sizing: content-box;
    }
    #method .method-figure-wrap .fig-img.loaded,
    #method .method-figure-wrap .fig-placeholder {
      width: 100%;
      max-width: none;
    }
    .method-figure-wrap .fig-placeholder {
      aspect-ratio: 2/1;
      max-height: 360px;
    }
    .method-figure-wrap .fig-caption {
      text-align: left;
    }
    .method-blocks {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
    }
    .method-block {
      padding: 20px;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 12px;
    }
    .method-block h4 {
      margin: 0 0 8px;
      font-size: 0.6rem;
      color: var(--accent);
      font-weight: 600;
    }
    .method-block p { margin: 0; font-size: 0.5rem; color: var(--text); }

    .results-intro {
      display: grid;
      grid-template-columns: 280px 1fr;
      gap: 40px;
      align-items: start;
      margin-bottom: 40px;
    }
    .fig-radar-wrap {
      width: 100%;
    }
    .fig-radar-wrap .fig-img.loaded,
    .fig-radar-wrap .fig-placeholder {
      width: 100%;
      max-width: none;
    }
    .results-intro:has(.fig-radar-wrap) {
      grid-template-columns: 1fr;
    }
    .results-bullets {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .results-bullets li {
      position: relative;
      padding-left: 1.25em;
      margin-bottom: 10px;
      font-size: 0.5rem;
    }
    .results-bullets li::before {
      content: "•";
      position: absolute;
      left: 0;
      color: var(--accent);
      font-weight: 700;
    }
    .results-figures {
      display: grid;
      grid-template-columns: 1fr;
      gap: 24px;
    }
    .fig-de-recovery-wrap {
      text-align: center;
    }
    .fig-de-recovery-wrap .fig-img.loaded,
    .fig-de-recovery-wrap .fig-placeholder {
      max-width: 70%;
      margin-left: auto;
      margin-right: auto;
      display: block;
    }
    .fig-scatter-wrap {
      text-align: center;
    }
    .fig-scatter-wrap .fig-img.loaded,
    .fig-scatter-wrap .fig-placeholder {
      max-width: 70%;
      margin-left: auto;
      margin-right: auto;
      display: block;
    }
    .results-figures .fig-placeholder { aspect-ratio: 16/10; }

    .pretraining-grid {
      display: grid;
      grid-template-columns: 1fr 320px;
      gap: 40px;
      align-items: start;
    }
    .pretraining-grid:has(.fig-zero-shot-wrap) {
      grid-template-columns: 1fr;
    }
    .fig-zero-shot-wrap,
    .fig-lowdata-wrap {
      text-align: center;
    }
    .fig-zero-shot-wrap .fig-img.loaded,
    .fig-zero-shot-wrap .fig-placeholder {
      max-width: 73%;
      width: 100%;
      margin-left: auto;
      margin-right: auto;
      display: block;
    }
    .fig-lowdata-wrap .fig-img.loaded,
    .fig-lowdata-wrap .fig-placeholder {
      max-width: 63%;
      margin-left: auto;
      margin-right: auto;
      display: block;
    }
    .pretraining-grid .fig-placeholder { aspect-ratio: 4/3; }

    .impact-text { max-width: 100%; font-size: 0.5rem; }
    .impact-text p { font-size: inherit; }

    .citation-block {
      background: #f8fafc;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 20px 24px;
      font-family: "SF Mono", Menlo, Monaco, Consolas, monospace;
      font-size: 11px;
      line-height: 1.5;
      overflow-x: auto;
      white-space: pre;
    }

    .footer {
      margin-top: var(--spacing-section);
      padding-top: 24px;
      border-top: 1px solid var(--border);
      font-size: 0.5rem;
      color: var(--text-muted);
    }

    @media (max-width: 768px) {
      .hero-title { font-size: 2rem; }
      .motivation-grid,
      .two-col-grid,
      .results-intro,
      .results-figures,
      .method-blocks,
      .pretraining-grid {
        grid-template-columns: 1fr;
      }
      .navbar-links { display: none; }
    }
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="navbar-inner">
      <a class="navbar-brand" href="#">PerturbDiff</a>
      <div class="navbar-links">
        <a href="#abstract">Abstract</a>
        <a href="#motivation">Motivation</a>
        <a href="#method">Method</a>
        <a href="#results">Results</a>
        <a href="#impact">Impact</a>
        <a href="#citation">Citation</a>
      </div>
    </div>
  </nav>

  <div class="page">
    <header class="hero">
      <h1 class="hero-title">
        <span class="hero-title-line"><span class="hero-title-highlight">PerturbDiff</span>: Functional Diffusion for</span>
        <span class="hero-title-line">Single-Cell Perturbation Modeling</span>
      </h1>
      <p class="hero-authors">
        <a href="#">Xinyu Yuan</a><sup>1,2,*</sup>, <a href="#">Xixian Liu</a><sup>1,2,*</sup>, <a href="#">Yashi Zhang</a><sup>1,2,*</sup>, <a href="#">Zuobai Zhang</a><sup>1,2</sup>, <a href="#">Hongyu Guo</a><sup>3,4</sup>, <a href="#">Jian Tang</a><sup>1,5,6,+</sup>
      </p>
      <p class="hero-affiliations">
        <sup>1</sup>Mila – Québec AI Institute &nbsp; <sup>2</sup>Université de Montréal &nbsp; <sup>3</sup>University of Ottawa &nbsp; <sup>4</sup>National Research Council of Canada &nbsp; <sup>5</sup>HEC Montréal &nbsp; <sup>6</sup>CIFAR AI Chair
      </p>
      <p class="hero-contribution">
        <span class="hero-contribution-line"><sup>*</sup>Equal Contribution; the first author led the project, and the others are ordered alphabetically.</span>
        <span class="hero-contribution-line"><sup>†</sup>Corresponding Author</span>
      </p>
      <div class="hero-logos">
        <img class="logo-mila" src="hero_fig/mila.png" alt="Mila" />
        <img class="logo-udem" src="hero_fig/udem.png" alt="Université de Montréal" />
        <img class="logo-ottawa" src="hero_fig/ott.png" alt="University of Ottawa" />
        <img class="logo-hec" src="hero_fig/hec.png" alt="HEC Montréal" />
      </div>
      <div class="hero-buttons">
        <a class="btn btn-primary" href="" target="_blank" rel="noopener"><svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M16 13H8"/><path d="M16 17H8"/><path d="M10 9H8"/></svg>Paper PDF</a>
        <a class="btn btn-secondary" href="https://github.com/DeepGraphLearning/PerturbDiff" target="_blank" rel="noopener"><svg class="btn-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/></svg>Code</a>
        <a class="btn btn-secondary" href="#citation"><svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 12h16"/><path d="M4 8h8"/><path d="M4 16h12"/></svg>BibTeX</a>
      </div>
    </header>

    <div class="page-content">
    <div class="hero-video-wrap">
      <video src="diffusion.mp4" controls playsinline preload="metadata"></video>
    </div>

    <section id="abstract">
      <h2 class="section-title">Abstract</h2>
      <p class="abstract">
        Building virtual cells that simulate cellular responses to perturbations is a central challenge in systems biology.
        Because single-cell sequencing is destructive, control and perturbed cells are unpaired, requiring distribution-level modeling.
        Existing methods assume a single fixed response distribution under each condition.
        However, unobserved latent factors such as microenvironment and batch effects induce a manifold of plausible response distributions.
        PerturbDiff models perturbation responses as distribution-valued random variables and defines a diffusion process directly in a reproducing kernel Hilbert space.
        Across signaling, drug, and genetic benchmarks, PerturbDiff achieves state-of-the-art performance and improved generalization.
      </p>
    </section>

    <section id="motivation">
      <h2 class="section-title">Motivation</h2>
      <div class="motivation-grid">
        <div class="fig-wrap">
          <img src="result_fig/fig_distribution_variability.png" alt="Distribution variability" class="fig-img" />
          <div class="fig-placeholder">fig_distribution_variability.png</div>
          <figcaption class="fig-caption"><strong>Distributional variability in single-cell perturbation data.</strong> (a) Traditional methods operate on unpaired control and perturbed cells, learning to map a control cell distribution to a perturbed one. (b) However, variations in cell distributions arise from unobserved latent factors, inducing a family of distinct cell distributions and shifting the objective to learning a distribution over cell distributions.</figcaption>
        </div>
        <div>
          <ul class="motivation-list">
            <li>Single-cell sequencing is destructive, thereby no cell-to-cell correspondence exists.</li>
            <li>Existing methods often assume a single perturbed distribution P<sub>c,τ</sub> when conditioned on observed the cell type c and perturbation type τ.</li>
            <li>In reality, unobservable latent biological and technical factors induce a distribution over distributions.</li>
            <li>We propose to model this variability at the distribution level.</li>
          </ul>
        </div>
      </div>
    </section>

    <section id="method">
      <h2 class="section-title">Method</h2>
      <div class="method-figure-wrap fig-wrap">
        <img src="result_fig/fig_framework.png" alt="Framework" class="fig-img" />
        <div class="fig-placeholder">fig_framework.png</div>
        <figcaption class="fig-caption"><strong>Overview of the PerturbDiff framework.</strong> (a) Distribution-valued random variables D<sub>c,τ</sub> and D<sub>c</sub> in cell space are mapped to Hilbert-space elements μ<sub>c,τ</sub> and μ<sub>c</sub> ∈ H<sub>k</sub> via kernel mean embedding. (b) Diffusion is defined on perturbed embeddings μ<sub>0</sub> := μ<sub>c,τ</sub>, with a denoising network predicting the target μ<sub>θ</sub>. (c) Each MM-DiT block performs joint attention over control and perturbed token streams.</figcaption>
      </div>
      <div class="method-blocks">
        <div class="method-block">
          <h4>Distribution as Random Variable</h4>
          <p>We treat perturbed populations as distribution-valued random variables D<sub>c,τ</sub>.</p>
        </div>
        <div class="method-block">
          <h4>Kernel Mean Embedding</h4>
          <p>Each distribution P is mapped to μ<sub>P</sub> in RKHS via kernel mean embedding.</p>
        </div>
        <div class="method-block">
          <h4>Diffusion in Function Space</h4>
          <p>We define a DDPM-style diffusion directly over μ in Hilbert space.</p>
        </div>
        <div class="method-block">
          <h4>MMD Objective</h4>
          <p>The Hilber-space diffusion derived denoising objective RKHS distance equals MMD, yielding a principled distribution-aware loss.</p>
        </div>
      </div>
    </section>

    <section id="results">
      <h2 class="section-title">Results</h2>
      <h3 class="subsection-title">Perturbation modeling</h3>
      <div class="results-intro">
        <div class="fig-wrap fig-radar-wrap">
          <img src="result_fig/fig_radar.png" alt="Radar plot" class="fig-img" />
          <div class="fig-placeholder">fig_radar.png</div>
        </div>
        <div>
          <ul class="results-bullets">
            <li>State-of-the-art on PBMC and Tahoe100M, competitive on Replogle.</li>
            <li>Strong differential expression recovery.</li>
            <li>Robust cross-dataset generalization.</li>
          </ul>
        </div>
      </div>
      <div class="results-figures">
        <div class="fig-wrap fig-scatter-wrap">
          <img src="result_fig/fig_scatter.png" alt="Scatter" class="fig-img" />
          <div class="fig-placeholder">fig_scatter.png</div>
        </div>
        <div>
          <ul class="results-bullets">
            <li>Consistent performance across perturbation types.</li>
          </ul>
        </div>
        <div class="fig-wrap fig-de-recovery-wrap">
          <img src="result_fig/fig_de_recovery.png" alt="DE recovery" class="fig-img" />
          <div class="fig-placeholder">fig_de_recovery.png</div>
        </div>
        <div>
          <ul class="results-bullets">
            <li>Accurate recovery of perturbation-driven differential expression (DE) patterns, compared to ground truth and the best baseline.</li>
          </ul>
        </div>
      </div>
      <h3 class="subsection-title">Pretraining</h3>
      <div>
        <ul class="results-bullets">
          <li>To improve data efficiency, PerturbDiff introduces marginal pretraining by leveraging 61M cells from scRNA-seq datasets in CellxGene.</li>
        </ul>
      </div>
      <div class="pretraining-grid">
        <div class="fig-wrap fig-zero-shot-wrap">
          <img src="result_fig/fig_zero_shot.png" alt="Zero-shot" class="fig-img" />
          <div class="fig-placeholder">fig_zero_shot.png</div>
        </div>
        <div>
          <ul class="results-bullets">
            <li>This stage enables non-trivial zero-shot performance.</li>
          </ul>
        </div>
        <div class="fig-wrap fig-lowdata-wrap">
          <img src="result_fig/fig_lowdata.png" alt="Low-data" class="fig-img" />
          <div class="fig-placeholder">fig_lowdata.png</div>
        </div>
        <div>
          <ul class="results-bullets">
            <li>This stage also improves low-data adaptation.</li>
          </ul>
        </div>
      </div>
    </section>

    <section id="impact">
      <h2 class="section-title">Impact</h2>
      <div class="impact-text">
        <p>PerturbDiff provides a principled framework for virtual cell modeling, accelerating perturbation prediction in functional genomics and drug discovery. Because predictions depend on training data, the model should be used as a decision-support tool alongside experimental validation.</p>
      </div>
    </section>

    <section id="citation">
      <h2 class="section-title">Citation</h2>
      <pre class="citation-block">@article{perturbdiff,
  title   = {PerturbDiff: Functional Diffusion for Single-Cell Perturbation Modeling},
  author  = {Xinyu Yuan, Xixian Liu, Yashi Zhang, Zuobai Zhang, Hongyu Guo, and Jian Tang},
  year    = {2025},
}</pre>
    </section>

    <footer class="footer">
      <p>PerturbDiff · Template co-designed with Gemini, ChatGPT, and Cursor.</p>
    </footer>
    </div>
  </div>

  <script>
    document.querySelectorAll('.fig-wrap .fig-img').forEach(function(img) {
      function showImg() {
        img.classList.add('loaded');
        var pl = img.nextElementSibling;
        if (pl && pl.classList.contains('fig-placeholder')) pl.classList.add('hidden');
      }
      img.addEventListener('load', showImg);
      if (img.complete && img.naturalWidth > 0) showImg();
    });
  </script>
</body>
</html>
